import{_ as Z,A as ee,B as te,u as oe,r as v,c as h,w as ae,o as re,e as i,f as d,g as u,p as m,j as t,F as V,m as o,k as f,l,x as N,q as n,z as p}from"./index-b8d30765.js";import{u as se}from"./categories-b55ea028.js";import{u as le}from"./tags-ab17ae30.js";import{u as ne}from"./exercises-a2ad682e.js";import{c as ie}from"./api-f0127578.js";import{C as de}from"./CategoryFormDialog-a585f5ab.js";import{T as ce}from"./TagList-1937b14f.js";import"./TagChip-689dc838.js";/* empty css                                                                */const ue={key:0,class:"d-flex justify-center my-8"},ge={key:0},me={class:"mt-4"},ye={class:"text-h3"},fe={class:"text-body-2 mb-4"},ve={class:"text-body-2 mb-4"},pe={class:"text-body-2"},_e={class:"d-flex align-center mb-2"},xe={key:0,class:"d-flex align-center mb-4"},Ce={key:1,class:"text-body-2 mb-4 text-grey"},we={key:2,class:"mb-4"},be={class:"d-flex justify-center py-4"},ke={__name:"CategoryDetailView",setup(De){const z=ee(),A=te(),r=se(),S=le(),T=ne(),_=oe(),b=v(!0),B=v(!0),x=v(null),k=v(!1),C=v(!1),$=v(!1),s=h(()=>parseInt(A.params.id));h(()=>{const a=r.categoryById(s.value),e=r.currentCategory;return a||(e&&e.id===s.value?e:null)});const M=h(()=>S.tagsByCategory(s.value)||[]),j=h(()=>T.exercisesByCategory(s.value)||[]),P=[{title:"Name",key:"name"},{title:"Description",key:"description"},{title:"Actions",key:"actions",sortable:!1,align:"end"}];function F(a){return _.formatDate(a)}function G(){k.value=!0}function J(){z.push({name:"tags",query:{category:s.value}})}async function K(a){try{await r.updateCategory(s.value,a,"name,description"),_.showSuccessMessage(`Category "${a.name}" updated successfully`),k.value=!1}catch(e){_.showErrorMessage(`Error updating category: ${e.message}`)}}function O(){C.value=!0}async function Q(){$.value=!0;try{await r.deleteCategory(s.value),_.showSuccessMessage(`Category "${r.currentCategory.name}" deleted successfully`),C.value=!1,z.push({name:"categories"})}catch(a){_.showErrorMessage(`Error deleting category: ${a.message}`)}finally{$.value=!1}}async function L(){b.value=!0,x.value=null;try{const a=await r.fetchCategory(s.value);r.currentCategory||(console.warn(`Category with ID ${s.value} not found after fetching`),x.value=`Category with ID ${s.value} could not be found`),S.tags.length===0&&await S.fetchTags()}catch(a){console.error(`Error loading category: ${a.message}`,a),x.value=`Error loading category: ${a.message}`}finally{b.value=!1}B.value=!0;try{T.exercises.length===0&&await T.fetchExercises({categoryId:s.value})}catch(a){console.error("Error loading exercises:",a)}finally{B.value=!1}}return ae(()=>A.params.id,()=>{L()}),re(async()=>{if(await L(),!r.currentCategory&&s.value)try{const e=(await ie.get(s.value)).data;r.$patch(y=>{y.currentCategory=e;const w=y.categories.findIndex(c=>c.id===s.value);w!==-1?y.categories[w]=e:y.categories.push(e)}),console.log("Manually loaded category:",e)}catch(a){console.error("Final attempt to load category failed:",a)}}),(a,e)=>{const y=i("v-progress-circular"),w=i("v-alert"),c=i("v-btn"),D=i("v-col"),q=i("v-row"),E=i("v-card-text"),I=i("v-card"),U=i("v-icon"),W=i("v-data-table"),H=i("v-spacer"),R=i("v-card-actions"),X=i("v-card-title"),Y=i("v-dialog");return d(),u("div",null,[m(" Loading state "),b.value?(d(),u("div",ue,[t(y,{indeterminate:"",color:"primary",size:"64"})])):x.value?(d(),u(V,{key:1},[m(" Error state "),t(w,{type:"error",class:"my-4"},{default:o(()=>[n(p(x.value),1)]),_:1})],2112)):(d(),u(V,{key:2},[m(" Category details "),f(r).currentCategory?(d(),u(V,{key:1},[m(" Header section with actions "),t(q,{class:"mb-4"},{default:o(()=>[t(D,{cols:"12",sm:"8"},{default:o(()=>[t(c,{variant:"text",to:"/categories","prepend-icon":"mdi-arrow-left",class:"mb-2"},{default:o(()=>e[5]||(e[5]=[n(" Back to Categories ")])),_:1}),l("h1",ye,p(f(r).currentCategory.name),1)]),_:1}),t(D,{cols:"12",sm:"4",class:"d-flex justify-end align-center"},{default:o(()=>[t(c,{color:"primary",variant:"outlined",class:"mr-2","prepend-icon":"mdi-pencil",onClick:G},{default:o(()=>e[6]||(e[6]=[n(" Edit ")])),_:1}),t(c,{color:"error",variant:"outlined","prepend-icon":"mdi-delete",onClick:O},{default:o(()=>e[7]||(e[7]=[n(" Delete ")])),_:1})]),_:1})]),_:1}),m(" Category details card "),t(I,{class:"mb-6"},{default:o(()=>[t(E,null,{default:o(()=>[t(q,null,{default:o(()=>[t(D,{cols:"12",md:"6"},{default:o(()=>[e[8]||(e[8]=l("div",{class:"text-body-1 font-weight-medium mb-1"},"Description",-1)),l("div",fe,p(f(r).currentCategory.description||"No description provided"),1),e[9]||(e[9]=l("div",{class:"text-body-1 font-weight-medium mb-1"},"Created",-1)),l("div",ve,p(F(f(r).currentCategory.created_at)),1),e[10]||(e[10]=l("div",{class:"text-body-1 font-weight-medium mb-1"},"Last Updated",-1)),l("div",pe,p(F(f(r).currentCategory.updated_at)),1)]),_:1}),t(D,{cols:"12",md:"6"},{default:o(()=>[l("div",_e,[e[11]||(e[11]=l("div",{class:"text-body-1 font-weight-medium"},"Tags",-1)),t(c,{variant:"text",density:"compact",icon:"mdi-plus",size:"small",color:"primary",class:"ml-2",onClick:J,title:"Add tags"})]),b.value?(d(),u("div",xe,[t(y,{indeterminate:"",size:"20",width:"2",class:"mr-2"}),e[12]||(e[12]=l("span",{class:"text-body-2"},"Loading tags...",-1))])):M.value.length===0?(d(),u("div",Ce," No tags associated with this category ")):(d(),u("div",we,[t(ce,{tags:M.value},null,8,["tags"])]))]),_:1})]),_:1})]),_:1})]),_:1}),m(" Exercises in this category "),e[18]||(e[18]=l("h2",{class:"text-h5 mb-4"},"Exercises in this Category",-1)),t(I,null,{default:o(()=>[B.value?(d(),N(E,{key:0},{default:o(()=>[l("div",be,[t(y,{indeterminate:"",color:"primary"})])]),_:1})):j.value.length===0?(d(),N(E,{key:1,class:"text-center py-8"},{default:o(()=>[t(U,{icon:"mdi-music-note-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),e[14]||(e[14]=l("h3",{class:"text-h6 mb-2"},"No exercises found",-1)),e[15]||(e[15]=l("p",{class:"text-body-2 text-grey mb-4"}," This category doesn't have any exercises yet ",-1)),t(c,{color:"primary","prepend-icon":"mdi-plus",to:{name:"exercises",query:{category:s.value.value}}},{default:o(()=>e[13]||(e[13]=[n(" Create Exercise ")])),_:1},8,["to"])]),_:1})):(d(),u(V,{key:2},[t(W,{headers:P,items:j.value,"items-per-page":5},{"item.actions":o(({item:g})=>[t(c,{icon:"",variant:"text",size:"small",color:"primary",to:{name:"exercise-detail",params:{id:g.id}}},{default:o(()=>[t(U,null,{default:o(()=>e[16]||(e[16]=[n("mdi-eye")])),_:1})]),_:2},1032,["to"])]),_:1},8,["items"]),t(R,null,{default:o(()=>[t(H),t(c,{color:"primary",variant:"text",to:{name:"exercises",query:{category:s.value.value}}},{default:o(()=>e[17]||(e[17]=[n(" View All Exercises ")])),_:1},8,["to"])]),_:1})],64))]),_:1})],64)):(d(),u("div",ge,[t(w,{type:"info",class:"my-4"},{default:o(()=>[e[4]||(e[4]=n(" Category not found. It may have been deleted. ")),l("div",me,[t(c,{color:"primary",to:"/categories"},{default:o(()=>e[3]||(e[3]=[n(" Back to Categories ")])),_:1})])]),_:1})]))],64)),m(" Edit Dialog "),f(r).currentCategory?(d(),N(de,{key:3,modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=g=>k.value=g),category:f(r).currentCategory,"is-edit":!0,onSave:K},null,8,["modelValue","category"])):m("v-if",!0),m(" Delete Confirmation Dialog "),t(Y,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=g=>C.value=g),"max-width":"500"},{default:o(()=>[t(I,null,{default:o(()=>[t(X,{class:"text-h5"},{default:o(()=>e[19]||(e[19]=[n("Delete Category")])),_:1}),t(E,null,{default:o(()=>{var g;return[e[20]||(e[20]=n(" Are you sure you want to delete the category ")),l("strong",null,p((g=f(r).currentCategory)==null?void 0:g.name),1),e[21]||(e[21]=n("? This will also remove it from all associated tags and exercises. This action cannot be undone. "))]}),_:1}),t(R,null,{default:o(()=>[t(H),t(c,{color:"grey-darken-1",variant:"text",onClick:e[1]||(e[1]=g=>C.value=!1)},{default:o(()=>e[22]||(e[22]=[n("Cancel")])),_:1}),t(c,{color:"error",variant:"flat",onClick:Q,loading:$.value},{default:o(()=>e[23]||(e[23]=[n(" Delete ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},ze=Z(ke,[["__file","/Users/zachjohnson/w/repos/tempus/frontend/src/views/categories/CategoryDetailView.vue"]]);export{ze as default};
//# sourceMappingURL=CategoryDetailView-b0fa851a.js.map
