{"version":3,"file":"CategoriesView-6bc85a23.js","sources":["../../src/views/categories/CategoriesView.vue"],"sourcesContent":["<template>\n  <div>\n    <v-row class=\"mb-4\">\n      <v-col cols=\"12\" sm=\"8\">\n        <h1 class=\"text-h3\">Categories</h1>\n        <p class=\"text-body-1\">Manage categories for organizing your exercises</p>\n      </v-col>\n      <v-col cols=\"12\" sm=\"4\" class=\"d-flex justify-end align-center\">\n        <v-btn\n          color=\"primary\"\n          prepend-icon=\"mdi-plus\"\n          @click=\"openCreateDialog\"\n        >\n          New Category\n        </v-btn>\n      </v-col>\n    </v-row>\n\n    <!-- Search -->\n    <v-card class=\"mb-6\">\n      <v-card-text>\n        <v-row>\n          <v-col cols=\"12\" sm=\"6\" md=\"4\">\n            <v-text-field\n              v-model=\"search\"\n              label=\"Search categories\"\n              variant=\"outlined\"\n              density=\"compact\"\n              prepend-inner-icon=\"mdi-magnify\"\n              hide-details\n              clearable\n            ></v-text-field>\n          </v-col>\n        </v-row>\n      </v-card-text>\n    </v-card>\n\n    <!-- Categories list -->\n    <v-card>\n      <v-card-text v-if=\"categoriesStore.loading\">\n        <div class=\"d-flex justify-center align-center py-4\">\n          <v-progress-circular indeterminate color=\"primary\"></v-progress-circular>\n        </div>\n      </v-card-text>\n      \n      <template v-else>\n        <v-data-table\n          v-if=\"filteredCategories.length > 0\"\n          :headers=\"headers\"\n          :items=\"filteredCategories\"\n          :items-per-page=\"10\"\n          class=\"elevation-1\"\n        >\n          <template v-slot:item.description=\"{ item }\">\n            <span v-if=\"item.description\">{{ truncateText(item.description, 80) }}</span>\n            <span v-else class=\"text-grey\">No description</span>\n          </template>\n          \n          <template v-slot:item.createdAt=\"{ item }\">\n            {{ formatDate(item.createdAt) }}\n          </template>\n\n          <template v-slot:item.actions=\"{ item }\">\n            <v-btn\n              icon\n              variant=\"text\"\n              size=\"small\"\n              color=\"primary\"\n              @click=\"openEditDialog(item)\"\n              class=\"mr-1\"\n            >\n              <v-icon>mdi-pencil</v-icon>\n            </v-btn>\n            <v-btn\n              icon\n              variant=\"text\"\n              size=\"small\"\n              color=\"primary\"\n              :to=\"{ name: 'category-detail', params: { id: item.id }}\"\n              class=\"mr-1\"\n            >\n              <v-icon>mdi-eye</v-icon>\n            </v-btn>\n            <v-btn\n              icon\n              variant=\"text\"\n              size=\"small\"\n              color=\"error\"\n              @click=\"confirmDelete(item)\"\n            >\n              <v-icon>mdi-delete</v-icon>\n            </v-btn>\n          </template>\n        </v-data-table>\n        \n        <v-card-text v-else class=\"text-center py-8\">\n          <v-icon icon=\"mdi-folder-off\" size=\"64\" color=\"grey-lighten-1\" class=\"mb-4\"></v-icon>\n          <h3 class=\"text-h6 mb-2\">No categories found</h3>\n          <p class=\"text-body-2 text-grey\">\n            {{ \n              categoriesStore.categories.length === 0 \n                ? \"You haven't created any categories yet\" \n                : \"No categories match your search criteria\" \n            }}\n          </p>\n        </v-card-text>\n      </template>\n    </v-card>\n\n    <!-- Create/Edit Dialog -->\n    <category-form-dialog\n      v-model=\"dialogVisible\"\n      :category=\"selectedCategory\"\n      :is-edit=\"isEdit\"\n      @save=\"saveCategory\"\n    />\n\n    <!-- Delete Confirmation Dialog -->\n    <v-dialog v-model=\"deleteDialog\" max-width=\"500\">\n      <v-card>\n        <v-card-title class=\"text-h5\">Delete Category</v-card-title>\n        <v-card-text>\n          Are you sure you want to delete the category <strong>{{ selectedCategory?.name }}</strong>? \n          This will also remove it from all associated tags and exercises. This action cannot be undone.\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"grey-darken-1\" variant=\"text\" @click=\"deleteDialog = false\">Cancel</v-btn>\n          <v-btn \n            color=\"error\" \n            variant=\"flat\" \n            @click=\"deleteCategory\" \n            :loading=\"deleteLoading\"\n          >\n            Delete\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useCategoriesStore } from '@/stores/categories.js'\nimport { useAppStore } from '@/stores/app.js'\nimport CategoryFormDialog from '@/components/categories/CategoryFormDialog.vue'\n\nconst categoriesStore = useCategoriesStore()\nconst appStore = useAppStore()\n\n// Data\nconst search = ref('')\nconst dialogVisible = ref(false)\nconst isEdit = ref(false)\nconst selectedCategory = ref(null)\nconst deleteDialog = ref(false)\nconst deleteLoading = ref(false)\n\n// Table headers\nconst headers = [\n  { title: 'Name', key: 'name' },\n  { title: 'Description', key: 'description' },\n  { title: 'Created', key: 'createdAt' },\n  { title: 'Actions', key: 'actions', sortable: false }\n]\n\n// Computed\nconst filteredCategories = computed(() => {\n  // First deduplicate the categories by ID\n  const uniqueCategories = []\n  const seenIds = new Set()\n  \n  categoriesStore.categories.forEach(category => {\n    if (!seenIds.has(category.id)) {\n      seenIds.add(category.id)\n      uniqueCategories.push(category)\n    }\n  })\n  \n  let result = uniqueCategories\n  \n  // Search filter\n  if (search.value) {\n    const searchLower = search.value.toLowerCase()\n    result = result.filter(category => \n      category.name.toLowerCase().includes(searchLower) || \n      (category.description && category.description.toLowerCase().includes(searchLower))\n    )\n  }\n  \n  return result\n})\n\n// Methods\nfunction formatDate(dateString) {\n  return appStore.formatDate(dateString)\n}\n\nfunction truncateText(text, maxLength) {\n  if (!text) return ''\n  return text.length > maxLength \n    ? text.substring(0, maxLength) + '...' \n    : text\n}\n\nfunction openCreateDialog() {\n  selectedCategory.value = {\n    name: '',\n    description: ''\n  }\n  isEdit.value = false\n  dialogVisible.value = true\n}\n\nfunction openEditDialog(category) {\n  selectedCategory.value = { ...category }\n  isEdit.value = true\n  dialogVisible.value = true\n}\n\nasync function saveCategory(categoryData) {\n  try {\n    if (isEdit.value) {\n      const id = selectedCategory.value.id\n      await categoriesStore.updateCategory(id, categoryData, 'name,description')\n      appStore.showSuccessMessage(`Category \"${categoryData.name}\" updated successfully`)\n    } else {\n      await categoriesStore.createCategory(categoryData)\n      appStore.showSuccessMessage(`Category \"${categoryData.name}\" created successfully`)\n    }\n    dialogVisible.value = false\n  } catch (error) {\n    appStore.showErrorMessage(`Error saving category: ${error.message}`)\n  }\n}\n\nfunction confirmDelete(category) {\n  selectedCategory.value = category\n  deleteDialog.value = true\n}\n\nasync function deleteCategory() {\n  deleteLoading.value = true\n  try {\n    await categoriesStore.deleteCategory(selectedCategory.value.id)\n    appStore.showSuccessMessage(`Category \"${selectedCategory.value.name}\" deleted successfully`)\n    deleteDialog.value = false\n  } catch (error) {\n    appStore.showErrorMessage(`Error deleting category: ${error.message}`)\n  } finally {\n    deleteLoading.value = false\n  }\n}\n\n// Lifecycle\nonMounted(async () => {\n  if (categoriesStore.categories.length === 0) {\n    await categoriesStore.fetchCategories()\n  }\n})\n</script>\n"],"names":["categoriesStore","useCategoriesStore","appStore","useAppStore","search","ref","dialogVisible","isEdit","selectedCategory","deleteDialog","deleteLoading","headers","filteredCategories","computed","uniqueCategories","seenIds","category","result","searchLower","formatDate","dateString","truncateText","text","maxLength","openCreateDialog","openEditDialog","saveCategory","categoryData","id","error","confirmDelete","deleteCategory","onMounted"],"mappings":"+bAoJA,MAAMA,EAAkBC,EAAmB,EACrCC,EAAWC,EAAY,EAGvBC,EAASC,EAAI,EAAE,EACfC,EAAgBD,EAAI,EAAK,EACzBE,EAASF,EAAI,EAAK,EAClBG,EAAmBH,EAAI,IAAI,EAC3BI,EAAeJ,EAAI,EAAK,EACxBK,EAAgBL,EAAI,EAAK,EAGzBM,EAAU,CACd,CAAE,MAAO,OAAQ,IAAK,MAAQ,EAC9B,CAAE,MAAO,cAAe,IAAK,aAAe,EAC5C,CAAE,MAAO,UAAW,IAAK,WAAa,EACtC,CAAE,MAAO,UAAW,IAAK,UAAW,SAAU,EAAM,CACtD,EAGMC,EAAqBC,EAAS,IAAM,CAExC,MAAMC,EAAmB,CAAC,EACpBC,EAAU,IAAI,IAEpBf,EAAgB,WAAW,QAAQgB,GAAY,CACxCD,EAAQ,IAAIC,EAAS,EAAE,IAC1BD,EAAQ,IAAIC,EAAS,EAAE,EACvBF,EAAiB,KAAKE,CAAQ,EAEpC,CAAG,EAED,IAAIC,EAASH,EAGb,GAAIV,EAAO,MAAO,CAChB,MAAMc,EAAcd,EAAO,MAAM,YAAY,EAC7Ca,EAASA,EAAO,OAAOD,GACrBA,EAAS,KAAK,cAAc,SAASE,CAAW,GAC/CF,EAAS,aAAeA,EAAS,YAAY,cAAc,SAASE,CAAW,CAClF,CACF,CAEA,OAAOD,CACT,CAAC,EAGD,SAASE,EAAWC,EAAY,CAC9B,OAAOlB,EAAS,WAAWkB,CAAU,CACvC,CAEA,SAASC,EAAaC,EAAMC,EAAW,CACrC,OAAKD,EACEA,EAAK,OAASC,EACjBD,EAAK,UAAU,EAAGC,CAAS,EAAI,MAC/BD,EAHc,EAIpB,CAEA,SAASE,GAAmB,CAC1BhB,EAAiB,MAAQ,CACvB,KAAM,GACN,YAAa,EACf,EACAD,EAAO,MAAQ,GACfD,EAAc,MAAQ,EACxB,CAEA,SAASmB,EAAeT,EAAU,CAChCR,EAAiB,MAAQ,CAAE,GAAGQ,CAAS,EACvCT,EAAO,MAAQ,GACfD,EAAc,MAAQ,EACxB,CAEA,eAAeoB,EAAaC,EAAc,CACxC,GAAI,CACF,GAAIpB,EAAO,MAAO,CAChB,MAAMqB,EAAKpB,EAAiB,MAAM,GAClC,MAAMR,EAAgB,eAAe4B,EAAID,EAAc,kBAAkB,EACzEzB,EAAS,mBAAmB,aAAayB,EAAa,IAAI,wBAAwB,CACxF,MACM,MAAM3B,EAAgB,eAAe2B,CAAY,EACjDzB,EAAS,mBAAmB,aAAayB,EAAa,IAAI,wBAAwB,EAEpFrB,EAAc,MAAQ,EACvB,OAAQuB,EAAO,CACd3B,EAAS,iBAAiB,0BAA0B2B,EAAM,OAAO,EAAE,CACrE,CACF,CAEA,SAASC,EAAcd,EAAU,CAC/BR,EAAiB,MAAQQ,EACzBP,EAAa,MAAQ,EACvB,CAEA,eAAesB,GAAiB,CAC9BrB,EAAc,MAAQ,GACtB,GAAI,CACF,MAAMV,EAAgB,eAAeQ,EAAiB,MAAM,EAAE,EAC9DN,EAAS,mBAAmB,aAAaM,EAAiB,MAAM,IAAI,wBAAwB,EAC5FC,EAAa,MAAQ,EACtB,OAAQoB,EAAO,CACd3B,EAAS,iBAAiB,4BAA4B2B,EAAM,OAAO,EAAE,CACzE,QAAY,CACRnB,EAAc,MAAQ,EACxB,CACF,CAGA,OAAAsB,EAAU,SAAY,CAChBhC,EAAgB,WAAW,SAAW,GACxC,MAAMA,EAAgB,gBAAgB,CAE1C,CAAC"}