{"version":3,"file":"TagFormDialog-6f407570.js","sources":["../../src/components/tags/TagFormDialog.vue"],"sourcesContent":["<template>\n  <v-dialog v-model=\"dialogModel\" max-width=\"600\" persistent>\n    <v-card>\n      <v-card-title class=\"text-h5\">\n        {{ isEdit ? `Edit Tag: ${originalTag?.name}` : 'Create New Tag' }}\n      </v-card-title>\n      \n      <v-card-text>\n        <v-form ref=\"form\" @submit.prevent=\"save\" v-model=\"formValid\">\n          <v-row>\n            <v-col cols=\"12\">\n              <v-text-field\n                v-model=\"formData.name\"\n                label=\"Tag Name\"\n                :rules=\"nameRules\"\n                required\n                variant=\"outlined\"\n                autofocus\n              ></v-text-field>\n            </v-col>\n            \n            <v-col cols=\"12\">\n              <v-select\n                v-model=\"formData.category_ids\"\n                :items=\"categoriesForSelect\"\n                label=\"Categories\"\n                multiple\n                chips\n                variant=\"outlined\"\n                :loading=\"categoriesStore.loading\"\n              >\n                <template v-slot:selection=\"{ item }\">\n                  <v-chip\n                    :key=\"item.raw.value\"\n                    closable\n                    @click:close=\"removeCategory(item.raw.value)\"\n                  >\n                    {{ item.title }}\n                  </v-chip>\n                </template>\n              </v-select>\n              <div class=\"text-caption text-grey\">\n                Assign this tag to one or more categories\n              </div>\n            </v-col>\n          </v-row>\n        </v-form>\n      </v-card-text>\n      \n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn\n          color=\"grey-darken-1\"\n          variant=\"text\"\n          @click=\"close\"\n        >\n          Cancel\n        </v-btn>\n        <v-btn\n          color=\"primary\"\n          variant=\"flat\"\n          @click=\"save\"\n          :disabled=\"!formValid || !formData.name\"\n          :loading=\"saving\"\n        >\n          {{ isEdit ? 'Update' : 'Create' }}\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n\n<script setup>\nimport { ref, computed, watch, onMounted } from 'vue'\nimport { useCategoriesStore } from '@/stores/categories.js'\n\n// Props\nconst props = defineProps({\n  modelValue: {\n    type: Boolean,\n    default: false\n  },\n  tag: {\n    type: Object,\n    default: null\n  },\n  isEdit: {\n    type: Boolean,\n    default: false\n  }\n})\n\n// Emits\nconst emit = defineEmits(['update:modelValue', 'save'])\n\n// Store\nconst categoriesStore = useCategoriesStore()\n\n// Data\nconst form = ref(null)\nconst formValid = ref(false)\nconst saving = ref(false)\nconst formData = ref({\n  name: '',\n  category_ids: []\n})\nconst originalTag = ref(null)\n\n// Computed\nconst dialogModel = computed({\n  get: () => props.modelValue,\n  set: (value) => emit('update:modelValue', value)\n})\n\nconst categoriesForSelect = computed(() => {\n  return categoriesStore.categories.map(category => ({\n    title: category.name,\n    value: category.id\n  }))\n})\n\n// Validation rules\nconst nameRules = [\n  v => !!v || 'Tag name is required',\n  v => (v && v.length >= 2) || 'Tag name must be at least 2 characters',\n  v => (v && v.length <= 30) || 'Tag name must be less than 30 characters'\n]\n\n// Methods\nfunction close() {\n  dialogModel.value = false\n}\n\nasync function save() {\n  if (!formValid.value) return\n  \n  saving.value = true\n  try {\n    // Prepare the data to emit\n    const tagData = {\n      name: formData.value.name,\n      category_ids: formData.value.category_ids.map(id => Number(id))\n    }\n    \n    // Emit save event with the form data\n    emit('save', tagData)\n  } catch (error) {\n    console.error('Error saving tag:', error)\n  } finally {\n    saving.value = false\n  }\n}\n\nfunction removeCategory(categoryId) {\n  formData.value.category_ids = formData.value.category_ids.filter(id => id !== categoryId)\n}\n\n// Reset form when dialog opens/closes\nwatch(() => props.modelValue, (isOpen) => {\n  if (isOpen && props.tag) {\n    // Clone the tag to avoid modifying the original\n    originalTag.value = { ...props.tag }\n    \n    // Set form values\n    formData.value = {\n      name: props.tag.name || '',\n      category_ids: props.tag.category_ids ? [...props.tag.category_ids] : []\n    }\n  } else {\n    // Reset form when dialog closes\n    if (form.value) {\n      form.value.reset()\n    }\n    formData.value = {\n      name: '',\n      category_ids: []\n    }\n    originalTag.value = null\n  }\n})\n\n// Load categories if not already loaded\nonMounted(async () => {\n  if (categoriesStore.categories.length === 0) {\n    await categoriesStore.fetchCategories()\n  }\n})\n</script>\n"],"names":["props","__props","emit","__emit","categoriesStore","useCategoriesStore","form","ref","formValid","saving","formData","originalTag","dialogModel","computed","value","categoriesForSelect","category","nameRules","v","close","save","tagData","id","error","removeCategory","categoryId","watch","isOpen","onMounted"],"mappings":"yXA6EA,MAAMA,EAAQC,EAgBRC,EAAOC,EAGPC,EAAkBC,EAAmB,EAGrCC,EAAOC,EAAI,IAAI,EACfC,EAAYD,EAAI,EAAK,EACrBE,EAASF,EAAI,EAAK,EAClBG,EAAWH,EAAI,CACnB,KAAM,GACN,aAAc,CAAC,CACjB,CAAC,EACKI,EAAcJ,EAAI,IAAI,EAGtBK,EAAcC,EAAS,CAC3B,IAAK,IAAMb,EAAM,WACjB,IAAMc,GAAUZ,EAAK,oBAAqBY,CAAK,CACjD,CAAC,EAEKC,EAAsBF,EAAS,IAC5BT,EAAgB,WAAW,IAAIY,IAAa,CACjD,MAAOA,EAAS,KAChB,MAAOA,EAAS,EACpB,EAAI,CACH,EAGKC,EAAY,CAChBC,GAAK,CAAC,CAACA,GAAK,uBACZA,GAAMA,GAAKA,EAAE,QAAU,GAAM,yCAC7BA,GAAMA,GAAKA,EAAE,QAAU,IAAO,0CAChC,EAGA,SAASC,GAAQ,CACfP,EAAY,MAAQ,EACtB,CAEA,eAAeQ,GAAO,CACpB,GAAKZ,EAAU,MAEf,CAAAC,EAAO,MAAQ,GACf,GAAI,CAEF,MAAMY,EAAU,CACd,KAAMX,EAAS,MAAM,KACrB,aAAcA,EAAS,MAAM,aAAa,IAAIY,GAAM,OAAOA,CAAE,CAAC,CAChE,EAGApB,EAAK,OAAQmB,CAAO,CACrB,OAAQE,EAAO,CACd,QAAQ,MAAM,oBAAqBA,CAAK,CAC5C,QAAY,CACRd,EAAO,MAAQ,EACjB,EACF,CAEA,SAASe,EAAeC,EAAY,CAClCf,EAAS,MAAM,aAAeA,EAAS,MAAM,aAAa,OAAOY,GAAMA,IAAOG,CAAU,CAC1F,CAGA,OAAAC,EAAM,IAAM1B,EAAM,WAAa2B,GAAW,CACpCA,GAAU3B,EAAM,KAElBW,EAAY,MAAQ,CAAE,GAAGX,EAAM,GAAI,EAGnCU,EAAS,MAAQ,CACf,KAAMV,EAAM,IAAI,MAAQ,GACxB,aAAcA,EAAM,IAAI,aAAe,CAAC,GAAGA,EAAM,IAAI,YAAY,EAAI,CAAC,CACxE,IAGIM,EAAK,OACPA,EAAK,MAAM,MAAM,EAEnBI,EAAS,MAAQ,CACf,KAAM,GACN,aAAc,CAAC,CACjB,EACAC,EAAY,MAAQ,KAExB,CAAC,EAGDiB,EAAU,SAAY,CAChBxB,EAAgB,WAAW,SAAW,GACxC,MAAMA,EAAgB,gBAAgB,CAE1C,CAAC"}