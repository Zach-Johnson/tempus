import{_ as ve,u as fe,r as _,c as A,o as pe,e as r,f as o,g as m,j as t,l as d,z as p,F as $,y as W,x,m as s,q as c,p as f,A as we,B as ke,w as Ee,k as E,C as Ve}from"./index-b8d30765.js";import{u as Se}from"./exercises-a2ad682e.js";import{u as ge}from"./categories-b55ea028.js";import{u as De}from"./tags-ab17ae30.js";import{u as he}from"./sessions-8c0d57dd.js";import{C as Be,E as Re}from"./CategoryChip-f1c14f75.js";import{C as $e}from"./CategoryFormDialog-a585f5ab.js";import{T as Ae}from"./TagList-1937b14f.js";import"./api-f0127578.js";import"./TagFormDialog-6f407570.js";/* empty css                                                                     */import"./TagChip-689dc838.js";/* empty css                                                                */const Ne={class:"category-list"},ze={key:0,class:"d-flex align-center"},Le={key:1,class:"text-body-2 text-grey"},Me={key:2,class:"category-list-container"},Ie={key:0,class:"d-inline-block"},Te={key:1,class:"text-center py-4"},Pe={__name:"CategoryList",props:{modelValue:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]},color:{type:String,default:"secondary"},variant:{type:String,default:"tonal"},size:{type:String,default:"small"},selectable:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},noCategoriesMessage:{type:String,default:"No categories"},showAddButton:{type:Boolean,default:!0},disableNavigation:{type:Boolean,default:!1}},emits:["update:modelValue","add","remove","category-created"],setup(v,{emit:X}){const y=v,n=X,V=ge(),N=fe(),g=_(!1),B=_(!1),S=_(""),D=A(()=>V.categoriesSorted),z=A(()=>{if(!S.value)return D.value;const i=S.value.toLowerCase();return D.value.filter(a=>a.name.toLowerCase().includes(i)||a.description&&a.description.toLowerCase().includes(i))});A(()=>y.modelValue?y.modelValue.map(i=>V.categoryById(i)||null).filter(i=>i!==null):[]);function L(i,a){return i?i.length>a?i.substring(0,a)+"...":i:""}function b(i){return y.modelValue&&y.modelValue.includes(i.id)}function M(){S.value="",g.value=!0}function R(){g.value=!1,B.value=!0}function Y(i){y.selectable&&(b(i)?C(i):h(i))}function h(i){if(!y.selectable||b(i))return;const a=[...y.modelValue||[],i.id];n("update:modelValue",a),n("add",i)}function C(i){if(!y.selectable)return;const a=(y.modelValue||[]).filter(I=>I!==i.id);n("update:modelValue",a),n("remove",i)}async function P(i){try{const a=await V.createCategory(i);N.showSuccessMessage(`Category "${i.name}" created successfully`),B.value=!1,y.selectable&&h(a),n("category-created",a)}catch(a){N.showErrorMessage(`Error creating category: ${a.message}`)}}return pe(async()=>{V.categories.length===0&&await V.fetchCategories()}),(i,a)=>{const I=r("v-progress-circular"),H=r("v-icon"),U=r("v-btn"),F=r("v-card-title"),Z=r("v-text-field"),ee=r("v-checkbox-btn"),te=r("v-list-item-title"),se=r("v-list-item-subtitle"),ae=r("v-list-item"),G=r("v-list"),J=r("v-card-text"),K=r("v-spacer"),oe=r("v-card-actions"),O=r("v-card"),l=r("v-dialog");return o(),m("div",Ne,[v.loading?(o(),m("div",ze,[t(I,{indeterminate:"",size:"20",width:"2",color:"primary",class:"mr-2"}),a[4]||(a[4]=d("span",{class:"text-body-2"},"Loading categories...",-1))])):!v.categories||v.categories.length===0?(o(),m("div",Le,p(v.noCategoriesMessage),1)):(o(),m("div",Me,[(o(!0),m($,null,W(v.categories,e=>(o(),x(Be,{key:e.id,category:e,color:v.color,variant:v.variant,size:v.size,closable:v.selectable&&v.modelValue&&v.modelValue.includes(e.id),clickable:v.selectable,"disable-navigation":v.disableNavigation,onClick:j=>Y(e),onClose:j=>C(e)},null,8,["category","color","variant","size","closable","clickable","disable-navigation","onClick","onClose"]))),128)),v.showAddButton&&v.selectable?(o(),m("div",Ie,[t(U,{variant:"outlined",size:v.size,icon:"",class:"category-add-btn",onClick:M},{default:s(()=>[t(H,null,{default:s(()=>a[5]||(a[5]=[c("mdi-plus")])),_:1})]),_:1},8,["size"])])):f("v-if",!0)])),f(" Category Selection Dialog "),t(l,{modelValue:g.value,"onUpdate:modelValue":a[2]||(a[2]=e=>g.value=e),"max-width":"500"},{default:s(()=>[t(O,null,{default:s(()=>[t(F,null,{default:s(()=>a[6]||(a[6]=[c("Add Categories")])),_:1}),t(J,null,{default:s(()=>[t(Z,{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value=e),label:"Search categories",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify",clearable:"",class:"mb-4"},null,8,["modelValue"]),D.value.length>0?(o(),x(G,{key:0,density:"compact"},{default:s(()=>[(o(!0),m($,null,W(z.value,e=>(o(),x(ae,{key:e.id,value:e.id,onClick:j=>h(e)},{prepend:s(()=>[t(ee,{"model-value":b(e),color:"primary"},null,8,["model-value"])]),default:s(()=>[t(te,null,{default:s(()=>[c(p(e.name),1)]),_:2},1024),e.description?(o(),x(se,{key:0},{default:s(()=>[c(p(L(e.description,60)),1)]),_:2},1024)):f("v-if",!0)]),_:2},1032,["value","onClick"]))),128))]),_:1})):(o(),m("div",Te,[a[8]||(a[8]=d("p",{class:"text-body-2 text-grey mb-4"},"No categories available",-1)),t(U,{color:"primary","prepend-icon":"mdi-plus",onClick:R},{default:s(()=>a[7]||(a[7]=[c(" Create New Category ")])),_:1})]))]),_:1}),t(oe,null,{default:s(()=>[t(K),t(U,{color:"primary",variant:"text",onClick:a[1]||(a[1]=e=>g.value=!1)},{default:s(()=>a[9]||(a[9]=[c(" Close ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),f(" Create Category Dialog "),t($e,{modelValue:B.value,"onUpdate:modelValue":a[3]||(a[3]=e=>B.value=e),category:{name:"",description:""},"is-edit":!1,onSave:P},null,8,["modelValue"])])}}},Ue=ve(Pe,[["__scopeId","data-v-e8faefc3"],["__file","/Users/zachjohnson/w/repos/tempus/frontend/src/components/categories/CategoryList.vue"]]);const Fe={key:0,class:"d-flex justify-center my-8"},je={key:0},qe={class:"mt-4"},He={class:"text-h3"},Ge={class:"text-body-2 mb-4"},Je={key:0,class:"text-body-2 mb-4 text-grey"},Ke={key:1,class:"mb-4"},Oe={key:2,class:"text-body-2 mb-4 text-grey"},Qe={key:3,class:"mb-4"},We={class:"text-body-2 mb-4"},Xe={class:"text-body-2"},Ye={key:0,class:"text-body-2 mb-4 text-grey"},Ze=["href"],et={class:"d-flex justify-end mt-2"},tt={class:"d-flex justify-center py-4"},st={class:"text-h4 text-center primary--text"},at={class:"text-h4 text-center primary--text"},ot={class:"text-h4 text-center primary--text"},lt={class:"text-h4 text-center primary--text"},rt={key:0,class:"ml-2"},it={__name:"ExerciseDetailView",setup(v){const X=we(),y=ke(),n=Se(),V=ge(),N=De(),g=fe(),B=he(),S=_(!0),D=_(null),z=_(!1),L=_(!1),b=_(null),M=_([]),R=_(!1),Y=_(null),h=_(!1),C=_({url:"",description:""}),P=_(!1),i=[l=>!!l||"URL is required",l=>/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w.-]*)*\/?$/.test(l)||"Enter a valid URL"],a=A(()=>parseInt(y.params.id)),I=A(()=>!n.currentExercise||!n.currentExercise.categoryIds?[]:n.currentExercise.categoryIds.map(l=>V.categoryById(l)).filter(Boolean)),H=A(()=>!n.currentExercise||!n.currentExercise.tagIds?[]:n.currentExercise.tagIds.map(l=>N.tagById(l)).filter(Boolean)),U=A(()=>M.value.length>0);function F(l){return g.formatDate(l)}function Z(l){return g.formatMinutes(l)}function ee(l,e){return g.formatDuration(l,e)}function te(){z.value=!0}function se(){C.value={url:"",description:""},R.value=!0}async function ae(l){try{await n.updateExercise(a.value,l,"name,description,categoryIds,tagIds"),g.showSuccessMessage(`Exercise "${l.name}" updated successfully`),z.value=!1}catch(e){g.showErrorMessage(`Error updating exercise: ${e.message}`)}}async function G(){if(h.value){P.value=!0;try{await n.addExerciseLink(a.value,{url:C.value.url,description:C.value.description}),g.showSuccessMessage("Resource added successfully"),R.value=!1,await n.fetchExercise(a.value)}catch(l){g.showErrorMessage(`Error adding resource: ${l.message}`)}finally{P.value=!1}}}async function J(){X.push({name:"new-session",query:{exercise:a.value}})}async function K(){L.value=!0;try{const l=await n.fetchExerciseStats(a.value);b.value=l}catch(l){console.error("Error loading exercise stats:",l),g.showErrorMessage("Failed to load exercise statistics")}finally{L.value=!1}}async function oe(){try{await B.fetchSessions({exercise_id:a.value,page_size:5}),M.value=B.sessions.filter(l=>l.exercises&&l.exercises.some(e=>e.exerciseId===a.value)).slice(0,5)}catch(l){console.error("Error loading recent sessions:",l)}}async function O(){S.value=!0,D.value=null;try{await n.fetchExercise(a.value),V.categories.length===0&&await V.fetchCategories(),N.tags.length===0&&await N.fetchTags(),await K(),await oe()}catch(l){console.error(`Error loading exercise: ${l.message}`,l),D.value=`Error loading exercise: ${l.message}`}finally{S.value=!1}}return Ee(()=>y.params.id,()=>{O()}),pe(async()=>{await O()}),(l,e)=>{const j=r("v-progress-circular"),ie=r("v-alert"),w=r("v-btn"),k=r("v-col"),q=r("v-row"),ne=r("v-icon"),de=r("v-list-item-title"),ce=r("v-list-item"),ue=r("v-list"),T=r("v-card-text"),Q=r("v-card"),le=r("v-spacer"),re=r("v-card-title"),_e=r("v-list-item-subtitle"),me=r("v-text-field"),ye=r("v-form"),xe=r("v-card-actions"),be=r("v-dialog");return o(),m("div",null,[f(" Loading state "),S.value?(o(),m("div",Fe,[t(j,{indeterminate:"",color:"primary",size:"64"})])):D.value?(o(),m($,{key:1},[f(" Error state "),t(ie,{type:"error",class:"my-4"},{default:s(()=>[c(p(D.value),1)]),_:1})],2112)):(o(),m($,{key:2},[f(" Exercise details "),E(n).currentExercise?(o(),m($,{key:1},[f(" Header section with actions "),t(q,{class:"mb-4"},{default:s(()=>[t(k,{cols:"12",sm:"8"},{default:s(()=>[t(w,{variant:"text",to:"/exercises","prepend-icon":"mdi-arrow-left",class:"mb-2"},{default:s(()=>e[8]||(e[8]=[c(" Back to Exercises ")])),_:1}),d("h1",He,p(E(n).currentExercise.name),1)]),_:1}),t(k,{cols:"12",sm:"4",class:"d-flex justify-end align-center"},{default:s(()=>[t(w,{color:"primary",variant:"outlined",class:"mr-2","prepend-icon":"mdi-pencil",onClick:te},{default:s(()=>e[9]||(e[9]=[c(" Edit ")])),_:1}),t(w,{color:"primary",variant:"flat","prepend-icon":"mdi-play",onClick:J},{default:s(()=>e[10]||(e[10]=[c(" Practice Now ")])),_:1})]),_:1})]),_:1}),f(" Exercise details card "),t(Q,{class:"mb-6"},{default:s(()=>[t(T,null,{default:s(()=>[t(q,null,{default:s(()=>[t(k,{cols:"12",md:"6"},{default:s(()=>[e[11]||(e[11]=d("div",{class:"text-body-1 font-weight-medium mb-1"},"Description",-1)),d("div",Ge,p(E(n).currentExercise.description||"No description provided"),1),e[12]||(e[12]=d("div",{class:"text-body-1 font-weight-medium mb-1"},"Categories",-1)),I.value.length===0?(o(),m("div",Je," No categories assigned ")):(o(),m("div",Ke,[t(Ue,{categories:I.value},null,8,["categories"])])),e[13]||(e[13]=d("div",{class:"text-body-1 font-weight-medium mb-1"},"Tags",-1)),H.value.length===0?(o(),m("div",Oe," No tags assigned ")):(o(),m("div",Qe,[t(Ae,{tags:H.value},null,8,["tags"])])),e[14]||(e[14]=d("div",{class:"text-body-1 font-weight-medium mb-1"},"Created",-1)),d("div",We,p(F(E(n).currentExercise.createdAt)),1),e[15]||(e[15]=d("div",{class:"text-body-1 font-weight-medium mb-1"},"Last Updated",-1)),d("div",Xe,p(F(E(n).currentExercise.updatedAt)),1)]),_:1}),t(k,{cols:"12",md:"6"},{default:s(()=>[e[17]||(e[17]=d("div",{class:"text-body-1 font-weight-medium mb-1"},"External Resources",-1)),!E(n).currentExercise.links||E(n).currentExercise.links.length===0?(o(),m("div",Ye," No external resources available ")):(o(),x(ue,{key:1,density:"compact",class:"mb-4"},{default:s(()=>[(o(!0),m($,null,W(E(n).currentExercise.links,(u,Ce)=>(o(),x(ce,{key:Ce},{prepend:s(()=>[t(ne,{icon:"mdi-link",size:"small"})]),default:s(()=>[t(de,null,{default:s(()=>[d("a",{href:u.url,target:"_blank",rel:"noopener noreferrer"},p(u.description||u.url),9,Ze)]),_:2},1024)]),_:2},1024))),128))]),_:1})),f(" Add resource button "),d("div",et,[t(w,{size:"small","prepend-icon":"mdi-plus",onClick:se},{default:s(()=>e[16]||(e[16]=[c(" Add Resource ")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),f(" Practice Statistics Card "),t(q,null,{default:s(()=>[t(k,{cols:"12"},{default:s(()=>[t(Q,null,{default:s(()=>[t(re,{class:"d-flex align-center"},{default:s(()=>[e[19]||(e[19]=c(" Practice Statistics ")),t(le),t(w,{variant:"text","prepend-icon":"mdi-refresh",onClick:K,loading:L.value},{default:s(()=>e[18]||(e[18]=[c(" Refresh ")])),_:1},8,["loading"])]),_:1}),L.value?(o(),x(T,{key:0},{default:s(()=>[d("div",tt,[t(j,{indeterminate:"",color:"primary"})])]),_:1})):b.value?(o(),x(T,{key:1},{default:s(()=>[t(q,null,{default:s(()=>[t(k,{cols:"12",sm:"6",md:"3"},{default:s(()=>[d("div",st,p(b.value.practiceCount),1),e[20]||(e[20]=d("div",{class:"text-body-2 text-center"},"Times Practiced",-1))]),_:1}),t(k,{cols:"12",sm:"6",md:"3"},{default:s(()=>[d("div",at,p(Z(b.value.totalPracticeDurationSeconds/60)),1),e[21]||(e[21]=d("div",{class:"text-body-2 text-center"},"Total Practice Time",-1))]),_:1}),t(k,{cols:"12",sm:"6",md:"3"},{default:s(()=>[d("div",ot,p(b.value.maxBpm||"N/A"),1),e[22]||(e[22]=d("div",{class:"text-body-2 text-center"},"Max BPM",-1))]),_:1}),t(k,{cols:"12",sm:"6",md:"3"},{default:s(()=>[d("div",lt,p(b.value.avgRating?b.value.avgRating.toFixed(1):"N/A"),1),e[23]||(e[23]=d("div",{class:"text-body-2 text-center"},"Average Rating",-1))]),_:1})]),_:1}),f(" BPM Progress Chart will be added here when we have data ")]),_:1})):(o(),x(T,{key:2,class:"text-center py-6"},{default:s(()=>[t(ne,{icon:"mdi-chart-timeline-variant",size:"64",color:"grey-lighten-1",class:"mb-4"}),e[25]||(e[25]=d("h3",{class:"text-h6 mb-2"},"No practice data available",-1)),e[26]||(e[26]=d("p",{class:"text-body-2 text-grey mb-4"}," Start practicing this exercise to collect statistics ",-1)),t(w,{color:"primary","prepend-icon":"mdi-play",onClick:J},{default:s(()=>e[24]||(e[24]=[c(" Practice Now ")])),_:1})]),_:1}))]),_:1})]),_:1})]),_:1}),f(" Recent Practice Sessions "),t(q,{class:"mt-4"},{default:s(()=>[t(k,{cols:"12"},{default:s(()=>[t(Q,null,{default:s(()=>[t(re,null,{default:s(()=>[e[28]||(e[28]=c(" Recent Practice Sessions ")),t(le),t(w,{variant:"text",to:"/sessions",disabled:!U.value},{default:s(()=>e[27]||(e[27]=[c(" View All ")])),_:1},8,["disabled"])]),_:1}),M.value.length>0?(o(),x(ue,{key:0},{default:s(()=>[(o(!0),m($,null,W(M.value,u=>(o(),x(ce,{key:u.id,to:`/sessions/${u.id}`},{default:s(()=>[t(de,null,{default:s(()=>[c(p(F(u.startTime)),1)]),_:2},1024),t(_e,null,{default:s(()=>[c(p(ee(u.startTime,u.endTime))+" ",1),u.bpm?(o(),m("span",rt,p(u.bpm)+" BPM",1)):f("v-if",!0)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})):(o(),x(T,{key:1,class:"text-center py-6"},{default:s(()=>e[29]||(e[29]=[d("p",{class:"text-body-2 text-grey"},"No recent practice sessions",-1)])),_:1}))]),_:1})]),_:1})]),_:1})],64)):(o(),m("div",je,[t(ie,{type:"info",class:"my-4"},{default:s(()=>[e[7]||(e[7]=c(" Exercise not found. It may have been deleted. ")),d("div",qe,[t(w,{color:"primary",to:"/exercises"},{default:s(()=>e[6]||(e[6]=[c(" Back to Exercises ")])),_:1})])]),_:1})]))],64)),f(" Edit Dialog "),E(n).currentExercise?(o(),x(Re,{key:3,modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=u=>z.value=u),exercise:E(n).currentExercise,"is-edit":!0,onSave:ae},null,8,["modelValue","exercise"])):f("v-if",!0),f(" Add Resource Dialog "),t(be,{modelValue:R.value,"onUpdate:modelValue":e[5]||(e[5]=u=>R.value=u),"max-width":"600"},{default:s(()=>[t(Q,null,{default:s(()=>[t(re,null,{default:s(()=>e[30]||(e[30]=[c("Add External Resource")])),_:1}),t(T,null,{default:s(()=>[t(ye,{ref_key:"resourceForm",ref:Y,onSubmit:Ve(G,["prevent"]),modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=u=>h.value=u)},{default:s(()=>[t(me,{modelValue:C.value.url,"onUpdate:modelValue":e[1]||(e[1]=u=>C.value.url=u),label:"URL",rules:i,required:"",variant:"outlined",placeholder:"https://example.com",class:"mb-4"},null,8,["modelValue"]),t(me,{modelValue:C.value.description,"onUpdate:modelValue":e[2]||(e[2]=u=>C.value.description=u),label:"Description",variant:"outlined",placeholder:"Description of the resource (optional)"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),t(xe,null,{default:s(()=>[t(le),t(w,{color:"grey-darken-1",variant:"text",onClick:e[4]||(e[4]=u=>R.value=!1)},{default:s(()=>e[31]||(e[31]=[c("Cancel")])),_:1}),t(w,{color:"primary",variant:"flat",onClick:G,disabled:!h.value,loading:P.value},{default:s(()=>e[32]||(e[32]=[c(" Add ")])),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Ct=ve(it,[["__scopeId","data-v-165c5a3d"],["__file","/Users/zachjohnson/w/repos/tempus/frontend/src/views/exercises/ExerciseDetailView.vue"]]);export{Ct as default};
//# sourceMappingURL=ExerciseDetailView-6659fcc5.js.map
